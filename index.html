<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V-Replenishment Tool | 门店补货清单生成器</title>
    <meta name="description" content="智能门店补货工具，自动识别新品和缺货产品，生成专业补货清单">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📦</text></svg>">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-header">
                <div class="logo">
                    <i class="fas fa-boxes"></i>
                    <span>V-Replenishment</span>
                </div>
                <span class="version">v1.0</span>
            </div>
            <h1>门店智能补货清单生成器</h1>
            <p class="subtitle">上传库存表和到货表，自动生成专业补货清单，智能识别新品和缺货产品</p>
        </header>

        <main>
            <!-- 文件上传区域 -->
            <div class="upload-section">
                <div class="upload-box" id="inventory-box">
                    <div class="upload-content">
                        <div class="upload-header">
                            <i class="fas fa-warehouse upload-icon"></i>
                            <h3>库存表 (实时库存)</h3>
                        </div>
                        <p class="upload-description">请上传从系统导出的实时库存Excel/CSV文件</p>
                        <div class="file-input-wrapper">
                            <input type="file" id="inventory-file" accept=".xlsx,.xls,.csv" class="file-input">
                            <label for="inventory-file" class="file-input-label">
                                <i class="fas fa-upload"></i> 选择文件
                            </label>
                            <span class="file-hint">或拖拽文件到此处</span>
                        </div>
                        <div id="inventory-filename" class="filename-display"></div>
                        <div class="file-requirements">
                            <p><strong>必需字段:</strong></p>
                            <ul>
                                <li>规格编码 (SKU/Barcode)</li>
                                <li>商品名称</li>
                                <li>总库存 (库存数量)</li>
                                <li>品牌、分类（可选）</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="upload-box" id="arrival-box">
                    <div class="upload-content">
                        <div class="upload-header">
                            <i class="fas fa-truck-loading upload-icon"></i>
                            <h3>到货表 (新到货物)</h3>
                        </div>
                        <p class="upload-description">请上传到货单Excel/CSV文件</p>
                        <div class="file-input-wrapper">
                            <input type="file" id="arrival-file" accept=".xlsx,.xls,.csv" class="file-input">
                            <label for="arrival-file" class="file-input-label">
                                <i class="fas fa-upload"></i> 选择文件
                            </label>
                            <span class="file-hint">或拖拽文件到此处</span>
                        </div>
                        <div id="arrival-filename" class="filename-display"></div>
                        <div class="file-requirements">
                            <p><strong>必需字段:</strong></p>
                            <ul>
                                <li>Barcode (SKU)</li>
                                <li>Item Number</li>
                                <li>Product name</li>
                                <li>Color, Size</li>
                                <li>Order Qty (到货数量)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 处理按钮 -->
            <div class="action-section">
                <button id="process-btn" class="process-btn" disabled>
                    <i class="fas fa-cogs"></i> 智能分析并生成补货清单
                </button>
                <div class="instructions">
                    <p><i class="fas fa-info-circle"></i> 系统将自动识别库存为0且到货表内有的产品，并智能标注新品</p>
                </div>
            </div>

            <!-- 结果展示区域 -->
            <div class="result-section">
                <div class="result-header">
                    <div class="result-title">
                        <h3><i class="fas fa-list-check"></i> 补货清单结果</h3>
                        <div class="result-actions">
                            <button id="export-btn" class="export-btn" disabled>
                                <i class="fas fa-file-excel"></i> 导出Excel
                            </button>
                            <button id="print-btn" class="print-btn">
                                <i class="fas fa-print"></i> 打印预览
                            </button>
                        </div>
                    </div>
                    
                    <div class="result-stats">
                        <div class="stat-card">
                            <span class="stat-label">总产品数</span>
                            <span id="total-items" class="stat-value">0</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-label">新品数量</span>
                            <span id="new-items" class="stat-value new-stat">0</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-label">缺货产品</span>
                            <span id="zero-stock-items" class="stat-value zero-stat">0</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-label">补货总量</span>
                            <span id="total-qty" class="stat-value qty-stat">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-legend">
                            <div class="legend-item">
                                <span class="legend-color new-legend"></span>
                                <span>新品</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color zero-legend"></span>
                                <span>库存为0</span>
                            </div>
                        </div>
                        <div class="table-search">
                            <input type="text" id="table-search" placeholder="搜索产品名称、编码或颜色...">
                            <i class="fas fa-search"></i>
                        </div>
                    </div>
                    <div class="table-scroll">
                        <table id="result-table">
                            <thead>
                                <tr>
                                    <th width="80">状态</th>
                                    <th width="100">ProductGender</th>
                                    <th width="120">Item Number</th>
                                    <th width="250">Product name</th>
                                    <th width="90">Color</th>
                                    <th width="70">Size</th>
                                    <th width="100">Order Qty</th>
                                    <th width="100">当前库存</th>
                                    <th width="120">品牌</th>
                                    <th width="120">分类</th>
                                    <th width="100">零售价</th>
                                    <th width="100">优先级</th>
                                </tr>
                            </thead>
                            <tbody id="result-table-body">
                                <!-- 数据将通过JavaScript动态插入 -->
                                <tr class="empty-row">
                                    <td colspan="12">
                                        <div class="empty-state">
                                            <i class="fas fa-clipboard-list"></i>
                                            <p>上传文件并点击"智能分析"生成补货清单</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="export-info">
                    <p><i class="fas fa-lightbulb"></i> 导出Excel文件将包含完整样式：等线字体、行颜色交替、新品高亮标注</p>
                </div>
            </div>

            <!-- 功能特性 -->
            <div class="features-section">
                <h3><i class="fas fa-star"></i> V-Replenishment 核心功能</h3>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h4>智能匹配</h4>
                        <p>自动通过SKU/Barcode匹配库存和到货数据，精准识别补货需求</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h4>新品识别</h4>
                        <p>智能识别库存中没有的新品，自动标注"NEW"并高亮显示</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-palette"></i>
                        </div>
                        <h4>专业样式</h4>
                        <p>导出专业Excel格式，等线字体、颜色交替、新品标黄，方便查阅</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-sort-amount-down"></i>
                        </div>
                        <h4>优先级排序</h4>
                        <p>自动计算补货优先级：新品 > 库存为0 > 库存不足</p>
                    </div>
                </div>
            </div>

            <!-- 使用说明 -->
            <div class="instructions-section">
                <h3><i class="fas fa-graduation-cap"></i> 使用指南</h3>
                <div class="instructions-timeline">
                    <div class="timeline-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>导出系统文件</h4>
                            <p>从门店零售系统中分别导出：<br>
                            • 实时库存表（包含规格编码、商品名称、总库存）<br>
                            • 到货表（包含Barcode、Item Number、Product name、Order Qty）</p>
                        </div>
                    </div>
                    <div class="timeline-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>上传文件</h4>
                            <p>将两个文件分别拖拽或点击上传到对应区域<br>
                            系统支持：Excel (.xlsx, .xls) 和 CSV 格式</p>
                        </div>
                    </div>
                    <div class="timeline-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>智能分析</h4>
                            <p>点击"智能分析"按钮，系统自动：<br>
                            • 匹配SKU识别补货产品<br>
                            • 标注新品并计算优先级<br>
                            • 生成可视化补货清单</p>
                        </div>
                    </div>
                    <div class="timeline-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>导出使用</h4>
                            <p>下载专业格式的Excel补货清单：<br>
                            • 等线字体，清晰易读<br>
                            • 颜色交替，防止看错行<br>
                            • 新品标黄，优先处理</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <div class="footer-content">
                <div class="footer-brand">
                    <i class="fas fa-boxes"></i>
                    <span>V-Replenishment Tool v1.0</span>
                </div>
                <div class="footer-links">
                    <a href="javascript:void(0)" onclick="showAbout()">关于</a>
                    <span class="divider">•</span>
                    <a href="javascript:void(0)" onclick="showHelp()">帮助</a>
                    <span class="divider">•</span>
                    <a href="https://github.com/yourusername/v-replenishment-tool" target="_blank">GitHub</a>
                </div>
                <p class="footer-copyright">© 2024 零售门店智能补货系统 | 为提升门店补货效率而生</p>
            </div>
        </footer>
    </div>

    <!-- 加载动画 -->
    <div id="loading" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <div class="loading-text">
                    <p>正在智能分析数据...</p>
                    <p class="loading-subtext">匹配产品中，请稍候</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 关于模态框 -->
    <div id="about-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> 关于 V-Replenishment Tool</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p><strong>版本：</strong> v1.0</p>
                <p><strong>功能：</strong> 智能门店补货清单生成器，自动识别新品和缺货产品</p>
                <p><strong>适用场景：</strong> 零售门店日常补货、新品上架、库存管理</p>
                <p><strong>技术支持：</strong> 基于现代Web技术，无需安装，支持所有现代浏览器</p>
                <div class="tech-stack">
                    <span class="tech-tag">HTML5</span>
                    <span class="tech-tag">CSS3</span>
                    <span class="tech-tag">JavaScript</span>
                    <span class="tech-tag">SheetJS</span>
                    <span class="tech-tag">Netlify</span>
                </div>
            </div>
        </div>
    </div>

    <!-- 帮助模态框 -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-question-circle"></i> 使用帮助</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h4>常见问题</h4>
                    <div class="faq-item">
                        <p class="faq-q">Q: 支持哪些文件格式？</p>
                        <p class="faq-a">A: 支持 Excel (.xlsx, .xls) 和 CSV 格式，建议使用系统导出的原始文件。</p>
                    </div>
                    <div class="faq-item">
                        <p class="faq-q">Q: 文件需要有特定格式吗？</p>
                        <p class="faq-a">A: 需要包含必要的字段（见上传区域的"必需字段"说明），列名可以不同，系统会自动识别。</p>
                    </div>
                    <div class="faq-item">
                        <p class="faq-q">Q: 新品是如何识别的？</p>
                        <p class="faq-a">A: 系统通过Barcode/SKU匹配，如果在库存表中找不到对应的SKU，则识别为新品。</p>
                    </div>
                </div>
                <div class="help-section">
                    <h4>字段说明</h4>
                    <p><strong>库存表必需字段：</strong> 规格编码 (SKU)、商品名称、总库存</p>
                    <p><strong>到货表必需字段：</strong> Barcode (SKU)、Item Number、Product name、Color、Size、Order Qty</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 引入脚本 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>